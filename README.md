## 背景
广勘白云分院实习期做的开发程序
## 项目简介
给定两个文件夹，放线和验收，里面包含若干需要提取属性的excel和word，文件组织如下
```
|--- 放线
|   |--- 2021放23B141
|   |   |--- 2021放23B141.txt
|   |--- 2021放23B314
|   |--- ...
|   |--- ...
|--- 验收
|   |--- 2021复23B133
|   |   |--- 技术审查表.xls
|   |   |--- 成果汇总表.doc
|   |--- 2021复23B160
|   |--- 2021复23B162
|   |--- ...
```
从中提取属性，然后汇总成两个表格
## 需求分析
1. 从放线验收两个文件夹中提取相应的属性，汇总成两个Excel表格
2. 比较提取成功的项目和清单列表的差异
3. 制作GUI界面
4. 异常处理
## 技术路线
**1. 技术审查Excel提取**
- 采用`xlrd3`库, 可以识别`xls`和`xlsx`两种文件格式
- 查找Excel文件下的`验收`表，如果`验收`不存在则无法提取数据
- 在`(27, B)` `(27, C)` `(28, B)` `(28, C)`中查找含`建筑高度`的单元格
- 查`(27, E)` `(27, F)` `(28, E)` `(28, F)`的对应的建筑高度

**有些文件上述对应关系不准确，如果查找的建筑高度为空会报异常**
  
**2. Word文件操作**
- 读取 本次Word都是表格类型的数据，直接采用`pywin32`库, 对Word文件自动化操作
- 按照每个属性对应的绝对位置提取内容
**3. 和清单比较异**
- 寻找程序路径下`放线数据汇总.xlsx`和`验收成果汇总表.xlsx`两个文件
- 提取两个的文件的`工程编号`,与指定清单路径的做对比
**4. GUI界面制作**
- 界面元素包括3个Label, 3个Checkout, 4个Button, 1个ProgressBar
- 选择放线、验收目录和清单路径，点击执行按钮即可执行, ProgressBar实时显示进度

**5. 异常处理**

异常主要分为以下几种情况  
Excel 
1. 放线的单元格读取有误，找不到对应的单元格项目
2. 验收建筑高度属性提取为空 
  
Word
1. 查找项目下的Word文件, 一个项目下可能没有Word文件
2. Word表格格式错误，提取失败

TXT
1. 查找项目下的TXT文件, 一个项目下可能没有TXT文件
2. 项目名称在文件的最下方，位置不固定，只能估计大致区间在这个区间内寻找，利用正则表达式匹配是否找到了项目名称，或者项目名称是否有误

对于以上异常，会将异常的具体文件转复制到文件夹下，并将异常的项目复制
## 打包命令
```shell
pip install pyinstaller
pyinstaller -F -c -w -i .ico\cloud.ico gui.py --hidden-import openpyxl.cell._writer
# 或者采用sepc文件
pyinstaller .\gui.spec
```

